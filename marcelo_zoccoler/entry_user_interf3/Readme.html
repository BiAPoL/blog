

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Custom user interfaces for Python (Part 3) &#8212; BiA-PoL blog</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'marcelo_zoccoler/entry_user_interf3/Readme';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Custom user interfaces for Python (Part 4)" href="../entry_user_interf4/Readme.html" />
    <link rel="prev" title="Custom user interfaces for Python (Part 2)" href="../../johannes_mueller/entry_user_interf2/Readme.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/biapol_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/biapol_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Blog Posts</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../mara_lampert/getting_started_with_mambaforge_and_python/readme.html">Getting started with Mambaforge and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../till_korten/devbio-napari_cluster/readme.html">Using GPU-accelerated image processing on the TUD HPC cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../till_korten/devbio-napari_cluster_setup/readme.html">Setting up GPU-accelerated image processing on the TUD HPC cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../omero_scripts/readme.html">Running Deep-Learning Scripts in the BiA-PoL Omero Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mini_sabbatical_rike/Readme.html">Mini-Sabbatical Experience at Bia-PoL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../johannes_mueller/anaconda_getting_started/Readme.html">Getting started with Anaconda and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../johannes_mueller/entry_sphinx/Readme.html">Automated package documentation with Sphinx</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../johannes_mueller/entry_user_inter/Readme.html">Custom user interfaces for Python (Part 1)</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../johannes_mueller/entry_user_interf2/Readme.html">Custom user interfaces for Python (Part 2)</a></li>

<li class="toctree-l2 current active"><a class="current reference internal" href="#">Custom user interfaces for Python (Part 3)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../entry_user_interf4/Readme.html">Custom user interfaces for Python (Part 4)</a></li>

</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jamovi/jamovi.html">Jamovi: statistical analysis made visual and easy (powered with R)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../robert_haase/ms_build_tools/readme.html">Installing Microsoft buildtools on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ryan_savill/principal_feature_analysis/readme.html">Principal Feature Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ryan_savill/03_background_subtraction/readme.html">Background Subtraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ryan_savill/02_intro_to_skimage/readme.html">Introduction to Image Analysis Basics in Python with Scikit Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../robert_haase/stardist_gpu/readme.html">Using StarDist in napari with GPU-support in Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ryan_savill/01_intro_to_python/readme.html">Introduction to Using Python for Image Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../robert_haase/cupy_cucim/readme.html">GPU-accelerated image processing using cupy and cucim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../robert_haase/browsing_idr/readme.html">Browsing the Open Microscopy Image Data Resource with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../robert_haase/clesperanto_google_colab/readme.html">GPU-accelerated image processing in the cloud using Google Colab and clEsperanto</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About the Blog</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../robert_haase/why_we_blog/readme.html">Why we blog</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../people.html">BiA-PoL blog authors</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../mara_lampert/readme.html">Mara Lampert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../johannes_mueller/Readme.html">Johannes Müller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../readme.html">Marcelo Zoccoler</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../ryan_savill/readme.html">Ryan Savill</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robert_haase/readme.html">Robert Haase</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../imprint.html">Imprint</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BiAPoL/blog" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BiAPoL/blog/issues/new?title=Issue%20on%20page%20%2Fmarcelo_zoccoler/entry_user_interf3/Readme.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/marcelo_zoccoler/entry_user_interf3/Readme.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Custom user interfaces for Python (Part 3)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Custom user interfaces for Python (Part 3)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-advanced-guis-for-napari">Creating advanced GUIs for napari</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-and-running-napari">Installing and running napari</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calling-napari-from-a-script">Calling napari from a script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-your-fancy-gui-to-napari">Importing your fancy GUI to napari</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-callback-function">Creating a callback function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#automatically-creating-a-gui-from-a-function-with-magicgui">Automatically creating a GUI from a function with magicgui</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-gui-from-functiongui">Creating a GUI from FunctionGui</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="custom-user-interfaces-for-python-part-3">
<h1>Custom user interfaces for Python (Part 3)<a class="headerlink" href="#custom-user-interfaces-for-python-part-3" title="Permalink to this heading">#</a></h1>
<p><a class="reference internal" href="../readme.html"><span class="doc std std-doc">Marcelo Zoccoler</span></a>, November 29th 2021</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Graphical user interfaces (<em>GUIs</em>) are powerful tools to make your scripts and functions available to users that are not necessarily familiar with a lot of coding, development platforms (e.g. Spyder or PyCharm) - and shouldn’t be experienced programmers in order to use your tools.</p>
<p>In this blog, we will cover a few interesting and versatile methods for you to create customized <a class="reference external" href="https://qt.io">Qt</a>-based GUIs for Python in general. Since our work revolves mostly around the visualization and processing of <strong>images</strong>, we will also show you a few ways to create great user interfaces for <a class="reference external" href="https://napari.org/">napari</a>.</p>
<p>Blogs on this topic will cover:</p>
<ul class="simple">
<li><p><span class="xref myst">Getting started (Part 1)</span></p></li>
<li><p><span class="xref myst">Creating standalone GUIs (Part 2)</span></p></li>
<li><p><span class="xref myst">Creating GUIs for napari (Part 3)</span></p></li>
<li><p><span class="xref myst">Turning napari GUI into plugins (Part 4)</span></p></li>
</ul>
</section>
</section>
<section id="creating-advanced-guis-for-napari">
<h1>Creating advanced GUIs for napari<a class="headerlink" href="#creating-advanced-guis-for-napari" title="Permalink to this heading">#</a></h1>
<p>The <span class="xref myst">previous entry</span> showed you how to create more advanced GUIs with the aid of the designer tool. This third part will teach you how to import those GUIs to napari and how to produce them straight from python functions using <a class="reference external" href="https://napari.org/magicgui/index.html">magicgui</a>.</p>
<section id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><span class="xref myst">Installing and running napari</span></p></li>
<li><p><span class="xref myst">Calling napari from a script</span></p></li>
<li><p><span class="xref myst">Importing your fancy GUI to napari</span></p></li>
<li><p><span class="xref myst">Creating a callback function</span></p></li>
<li><p><span class="xref myst">Automatically creating a GUI from a function with magicgui</span></p></li>
<li><p><span class="xref myst">Creating a GUI from FunctionGui</span></p></li>
<li><p><span class="xref myst">Conclusion</span></p></li>
</ul>
</section>
<section id="installing-and-running-napari">
<h2>Installing and running napari<a class="headerlink" href="#installing-and-running-napari" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference external" href="https://napari.org/">napari website</a> has a more complete <a class="reference external" href="https://napari.org/tutorials/fundamentals/installation.html">installation tutorial</a>, but, overall, you should <a class="reference external" href="https://biapol.github.io/blog/johannes_mueller/entry_user_interf2/Readme#creating-your-environment">create a new conda environment</a> and then type</p>
<p><code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">napari</span></code></p>
<p>or</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">napari[all]</span></code></p>
<p>in the command line. You can check if the installation was successful by calling <code class="docutils literal notranslate"><span class="pre">napari</span></code> from the command line and verifying if this window opens:</p>
<p><img alt="" src="../../_images/napari_window.png" /></p>
<p>You can now add images to it by drag and drop! Pretty easy right? Why don’t you give it a try before we continue?
Download the image above and drop it into napari by drag and drop (or use the usual “File -&gt; Open File(s)…”). You should have this:</p>
<p><img alt="" src="../../_images/napari_window_in_napari.png" /></p>
<p><strong>Wow! We have napari inside napari!</strong> ~~And that’s how you add a GUI to napari! 😆~~</p>
</section>
<section id="calling-napari-from-a-script">
<h2>Calling napari from a script<a class="headerlink" href="#calling-napari-from-a-script" title="Permalink to this heading">#</a></h2>
<p>Sometimes, it may be convenient to call the napari viewer from a script in order to display a series of image processing steps pre-defined in Python code. This can be done in a couple lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">napari</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
</pre></div>
</div>
<p>The code above can be called from <a class="reference external" href="https://jupyter.org/">Jupyter Notebook or JupyterLab</a>, <a class="reference external" href="https://www.spyder-ide.org/">Spyder</a>, or your editor of preference.
It is also possible to add images to the viewer from code. Download this image: <a class="reference external" href="https://github.com/BiAPoL/blog/tree/master/marcelo_zoccoler/entry_user_interf3/images/21_Map_of_Tabuaeran_Kiribati_blue.png">Astronaut photo of Tabuaeran, Kiribati with villages and main landmarks</a> by Government of USA, Government of Kiribati, under license CC BY-SA 3.0 <a class="reference external" href="https://creativecommons.org/licenses/by-sa/3.0">https://creativecommons.org/licenses/by-sa/3.0</a>, via Wikimedia Commons, where the following changes were made: green and red channels removed, then image was inverted regarding intensity.
Put the image in the same folder as the code and let’s expand it a bit:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">napari</span>
<span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>

<span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
<span class="n">napari_image</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;21_Map_of_Tabuaeran_Kiribati_blue.png&#39;</span><span class="p">)</span>      <span class="c1"># Reads an image from file</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">napari_image</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;napari_island&#39;</span><span class="p">)</span>                <span class="c1"># Adds the image to the viewer and give the image layer a name</span>
</pre></div>
</div>
<p>After executing the block of code above, you should see the napari window like this:
(<code class="docutils literal notranslate"><span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">'skimage'</span></code>? Remember to install scikit-image in your environment with <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">scikit-image</span></code>)</p>
<p><img alt="" src="../../_images/napari_island_in_napari.png" /></p>
<p><strong>Wow! We have napari inside napari! [2]</strong></p>
<p><em>Side-note: the napari island is part of the Kiribati country, which like Fiji, is also vulnerable to <a class="reference external" href="https://storymaps.arcgis.com/stories/7f455136b85f4edd8655d15a89b5039f">climate change effect</a>.</em></p>
</section>
<section id="importing-your-fancy-gui-to-napari">
<h2>Importing your fancy GUI to napari<a class="headerlink" href="#importing-your-fancy-gui-to-napari" title="Permalink to this heading">#</a></h2>
<p>Here, I modified a bit the GUI from the <span class="xref myst">previous post</span> and it looks like this:</p>
<p><img alt="" src="../../_images/flood_tool_gui.png" /></p>
<p>You can find the ‘.ui’ file to open this GUI with the designer <a class="reference external" href="https://github.com/BiAPoL/blog/raw/master/marcelo_zoccoler/entry_user_interf3/scripts/flood_tool.ui">here</a>. Download it and save it to the same folder of your code.</p>
<p>Now let’s add it to napari! Modify the script as shown below:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">napari</span>
<span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>
<span class="kn">from</span> <span class="nn">qtpy.QtWidgets</span> <span class="kn">import</span> <span class="n">QMainWindow</span>
<span class="kn">from</span> <span class="nn">qtpy</span> <span class="kn">import</span> <span class="n">uic</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># Define the main window class</span>
<span class="k">class</span> <span class="nc">FancyGUI</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">napari_viewer</span><span class="p">):</span>          <span class="c1"># include napari_viewer as argument (it has to have this name)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span> <span class="o">=</span> <span class="n">napari_viewer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UI_FILE</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;flood_tool.ui&quot;</span><span class="p">)</span>  <span class="c1"># path to .ui file</span>
        <span class="n">uic</span><span class="o">.</span><span class="n">loadUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UI_FILE</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>           <span class="c1"># load QtDesigner .ui file</span>

<span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
<span class="n">napari_image</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;21_Map_of_Tabuaeran_Kiribati_blue.png&#39;</span><span class="p">)</span>      <span class="c1"># Reads an image from file</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">napari_image</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;napari_island&#39;</span><span class="p">)</span>                <span class="c1"># Adds the image to the viewer and give the image layer a name</span>

<span class="n">flood_widget</span> <span class="o">=</span> <span class="n">FancyGUI</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>                                     <span class="c1"># Create instance from our class</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">add_dock_widget</span><span class="p">(</span><span class="n">flood_widget</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>           <span class="c1"># Add our gui instance to napari viewer</span>
</pre></div>
</div>
<p>This code does:</p>
<ul class="simple">
<li><p>Define a class that initializes your GUI (named ‘FancyGUI’ in this case);</p></li>
<li><p>Pass the napari viewer as an argument to this class (with <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">__init__(self,</span> <span class="pre">napari_viewer):</span></code>);</p></li>
<li><p>Import and applies your GUI (with <code class="docutils literal notranslate"><span class="pre">uic.loadUi(self.UI_FILE,</span> <span class="pre">self)</span></code>);</p></li>
<li><p>Add an instance of this class to the viewer (<code class="docutils literal notranslate"><span class="pre">viewer.window.add_dock_widget(flood_widget,</span> <span class="pre">area='right')</span></code>).</p></li>
</ul>
<p>When you run the script, you should see the screen below:</p>
<p><img alt="" src="../../_images/napari_flood_tool1.png" /></p>
<p>It is now embedded into napari! Sweet 🍬!</p>
<p>If you want to update your GUI layout, let’s say, by changing a button color, you can go back to designer, select the button and fill the <code class="docutils literal notranslate"><span class="pre">styleSheet</span></code> field by clicking on <code class="docutils literal notranslate"><span class="pre">...</span></code>:</p>
<p><img alt="" src="../../_images/designer_stylesheet0.png" /></p>
<p>and choosing colors (background, border, etc) by clicking on the small arrowhead next to “Add color”:</p>
<p><img alt="" src="../../_images/designer_stylesheet.png" /></p>
<p>It will add a line with the chosen color in <a class="reference external" href="https://www.w3schools.com/css/css_syntax.asp">CSS syntax</a>. Many lines can be added (each ending with <code class="docutils literal notranslate"><span class="pre">;</span></code>) to further elaborate the style.</p>
<p><img alt="" src="../../_images/napari_flood_tool1b.png" /></p>
</section>
<section id="creating-a-callback-function">
<h2>Creating a callback function<a class="headerlink" href="#creating-a-callback-function" title="Permalink to this heading">#</a></h2>
<p>As you may have noticed, our GUI is there, but it does nothing yet. We need to link click/change events to callback functions.
Just for fun, let’s create a function that relates temperature increases to sea level.</p>
<p><em><strong>Disclaimer:</strong> This specific function, although based on the fact that global warming contributes to increase sea levels, has no scientific background to support it, and it was completely made-up just for a fun illustration. Climate change is a complex subject that involves many internal and external factors which I do not have the expertise to explain.</em></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">flood</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
    <span class="n">new_level</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="mi">85</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">image</span> <span class="o">&lt;=</span> <span class="n">new_level</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">label_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span>     <span class="c1"># label number 13 is blue in napari</span>
    <span class="k">return</span><span class="p">(</span><span class="n">label_image</span><span class="p">,</span> <span class="n">new_level</span><span class="p">)</span>
</pre></div>
</div>
<p>This function takes an <code class="docutils literal notranslate"><span class="pre">image</span></code> and a <code class="docutils literal notranslate"><span class="pre">delta</span></code> (temperature) as inputs. It converts delta into <code class="docutils literal notranslate"><span class="pre">new_level</span></code> (new sea level) and creates a label image where the labeled region corresponds to grayscale levels which are below <code class="docutils literal notranslate"><span class="pre">new_level</span></code>. It returns <code class="docutils literal notranslate"><span class="pre">label_image</span></code> and <code class="docutils literal notranslate"><span class="pre">new_level</span></code>. It can be simplified, but let’s keep it like this for future reasons.</p>
<p>Now, we need to link this function to the ‘Apply’ button. This can be done with the general command <code class="docutils literal notranslate"><span class="pre">pushButton.clicked.connect(callback_function)</span></code>.
Let’s write a callback function that calls our flood function:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">apply_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">label</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">flood</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
</pre></div>
</div>
<p>We now have to specify to our callback where it gets the variables <code class="docutils literal notranslate"><span class="pre">image</span></code> and <code class="docutils literal notranslate"><span class="pre">delta</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">image</span></code> is the input image layer in napari, so let’s store it as a numpy array with <code class="docutils literal notranslate"><span class="pre">image</span> <span class="pre">=</span> <span class="pre">self.viewer.layers['napari_island'].data</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> is the input value inside the Spinbox widget, so let’s get it with <code class="docutils literal notranslate"><span class="pre">delta</span> <span class="pre">=</span> <span class="pre">self.doubleSpinBox.value()</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code> is the output label image, we have to add it to the viewer with <code class="docutils literal notranslate"><span class="pre">self.viewer.add_labels(label)</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">level</span></code> is the output sea level, which we want also to show as our Slider widget, so we set it with <code class="docutils literal notranslate"><span class="pre">self.horizontalSlider.setValue(level)</span></code>.</p></li>
</ul>
<p>Lastly, we use a flag (<code class="docutils literal notranslate"><span class="pre">self.label_layer</span></code>) to update the label layer rather than creating a new one every time. The code now looks like this:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">napari</span>
<span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>
<span class="kn">from</span> <span class="nn">qtpy.QtWidgets</span> <span class="kn">import</span> <span class="n">QMainWindow</span>
<span class="kn">from</span> <span class="nn">qtpy</span> <span class="kn">import</span> <span class="n">uic</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span> <span class="nf">flood</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
    <span class="n">new_level</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="mi">85</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">image</span> <span class="o">&lt;=</span> <span class="n">new_level</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">label_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span>  <span class="c1"># label 13 is blue in napari</span>
    <span class="k">return</span><span class="p">(</span><span class="n">label_image</span><span class="p">,</span> <span class="n">new_level</span><span class="p">)</span>

<span class="c1"># Define the main window class</span>
<span class="k">class</span> <span class="nc">FancyGUI</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">napari_viewer</span><span class="p">):</span>          <span class="c1"># include napari_viewer as argument (it has to have this name)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span> <span class="o">=</span> <span class="n">napari_viewer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UI_FILE</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;flood_tool.ui&quot;</span><span class="p">)</span>  <span class="c1"># path to .ui file</span>
        <span class="n">uic</span><span class="o">.</span><span class="n">loadUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UI_FILE</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>           <span class="c1"># load QtDesigner .ui file</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_layer</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1"># stored label layer variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">apply_delta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;napari_island&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>    <span class="c1"># We chose to use the layer name to find the correct image layer</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">label</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">flood</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_layer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">add_labels</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_layer</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalSlider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

<span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
<span class="n">napari_image</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;21_Map_of_Tabuaeran_Kiribati_blue.png&#39;</span><span class="p">)</span>    <span class="c1"># Reads an image from file</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">napari_image</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;napari_island&#39;</span><span class="p">)</span>              <span class="c1"># Adds the image to the viewer and give the image layer a name</span>

<span class="n">flood_widget</span> <span class="o">=</span> <span class="n">FancyGUI</span><span class="p">(</span><span class="n">viewer</span><span class="p">)</span>                                          <span class="c1"># Create instance from our class</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">add_dock_widget</span><span class="p">(</span><span class="n">flood_widget</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>                  <span class="c1"># Add our gui instance to napari viewer</span>
</pre></div>
</div>
<p>Now when we increase the temperature and click Apply, the island starts to flood :cold_sweat::ocean::</p>
<p><img alt="" src="../../_images/napari_flood_tool2.png" /></p>
</section>
<section id="automatically-creating-a-gui-from-a-function-with-magicgui">
<h2>Automatically creating a GUI from a function with magicgui<a class="headerlink" href="#automatically-creating-a-gui-from-a-function-with-magicgui" title="Permalink to this heading">#</a></h2>
<p>What if we could ‘magically’ simplify all that and just say: ‘Dear computer, please create a GUI for my function’?
We can ~~literally~~ almost do that with 🧙‍♂️<a class="reference external" href="https://napari.org/magicgui/index.html">magicgui</a>! If we put some annotations right next to the variables in our function, we can create the GUI with one line of code 😻 ! So let’s not wait any longer and add those annotations to our function:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">napari.types</span> <span class="kn">import</span> <span class="n">ImageData</span><span class="p">,</span> <span class="n">LabelsData</span>

<span class="k">def</span> <span class="nf">flood</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">ImageData</span><span class="p">,</span> <span class="n">delta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">new_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelsData</span><span class="p">:</span> 
    <span class="n">new_level</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="mi">85</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">image</span> <span class="o">&lt;=</span> <span class="n">new_level</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">label_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span> <span class="c1"># label 13 is blue in napari</span>
    <span class="k">return</span><span class="p">(</span><span class="n">label_image</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we are specifying that:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">image</span></code> is data from a napari image layer (<code class="docutils literal notranslate"><span class="pre">ImageData</span></code>);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> is <code class="docutils literal notranslate"><span class="pre">float</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">new_level</span></code> is <code class="docutils literal notranslate"><span class="pre">integer</span></code>;</p></li>
<li><p>output <code class="docutils literal notranslate"><span class="pre">label_image</span></code> will hold data from a napari labels layer (<code class="docutils literal notranslate"><span class="pre">LabelsData</span></code>).</p></li>
</ul>
<p>You may have noticed that we placed <code class="docutils literal notranslate"><span class="pre">new_level</span></code> as input instead of output. That’s because magicgui creates widgets (like buttons, sliders, etc) based on the input variables.</p>
<p>Now, here it comes… the one-liner: 🥁🥁</p>
<p><code class="docutils literal notranslate"><span class="pre">flood_widget</span> <span class="pre">=</span> <span class="pre">magicgui(flood)</span></code></p>
<p>Done! GUI was created and stored in <code class="docutils literal notranslate"><span class="pre">flood_widget</span></code>. The full code and the result become like this:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">napari</span>
<span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>
<span class="kn">from</span> <span class="nn">magicgui</span> <span class="kn">import</span> <span class="n">magicgui</span>
<span class="kn">from</span> <span class="nn">napari.types</span> <span class="kn">import</span> <span class="n">ImageData</span><span class="p">,</span> <span class="n">LabelsData</span>

<span class="k">def</span> <span class="nf">flood</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">ImageData</span><span class="p">,</span> <span class="n">delta</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_level</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelsData</span><span class="p">:</span> 
    <span class="n">new_level</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="mi">85</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">image</span> <span class="o">&lt;=</span> <span class="n">new_level</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">label_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span> <span class="c1"># label 13 is blue in napari</span>
    <span class="k">return</span><span class="p">(</span><span class="n">label_image</span><span class="p">)</span>

<span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
<span class="n">napari_image</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;21_Map_of_Tabuaeran_Kiribati_blue.png&#39;</span><span class="p">)</span>    <span class="c1"># Reads an image from file</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">napari_image</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;napari_island&#39;</span><span class="p">)</span>              <span class="c1"># Adds the image to the viewer and give the image layer a name </span>

<span class="n">flood_widget</span> <span class="o">=</span> <span class="n">magicgui</span><span class="p">(</span><span class="n">flood</span><span class="p">)</span>                                    <span class="c1"># Create GUI with magicgui</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">add_dock_widget</span><span class="p">(</span><span class="n">flood_widget</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>         <span class="c1"># Add our gui instance to napari viewer</span>
</pre></div>
</div>
<img alt="figure 3" src="../../_images/napari_flood_tool3.png" />
<p>Neat! Just a couple of things missing though. We only get Spinboxes now, what about the Slider? Don’t worry, we can fix this still maintaining the “one-liner”, although a bigger one now 😬 . We can add widget options as python dictionaries, like this:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">flood_widget</span> <span class="o">=</span> <span class="n">magicgui</span><span class="p">(</span><span class="n">flood</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature Increase (Δ°C):&#39;</span><span class="p">,</span> 
                                           <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
                                <span class="n">new_level</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;Sea Level (dm):&#39;</span><span class="p">,</span> <span class="s1">&#39;widget_type&#39;</span><span class="p">:</span><span class="s1">&#39;Slider&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span> <span class="p">:</span> <span class="mi">255</span><span class="p">,</span> <span class="s1">&#39;enabled&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
                                <span class="n">auto_call</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, you get practically the same result as the earlier approach. If you don’t know the widget options, take a look <a class="reference external" href="https://napari.org/magicgui/usage/widget_overview.html">here</a> to find the widget you want and discover more about its parameters.
We discarded the button here by using <code class="docutils literal notranslate"><span class="pre">auto_call=True</span></code>. This means that the callback function will be executed whenever the user change any of the inputs. This results in a smoother usability, but be careful, because if the callback function is too slow, it may get called several times before returning, which can lead to frozen screens.</p>
<img alt="figure 4" src="../../_images/napari_flood_tool4.png" />
<p>One thing missing is that the ‘Sea level’ slider does not get updated since it is an input now. But, we can append a callback function to the spinbox that updates the slider every time delta changes! Add the following code after creating the widget with magicgui (thanks Talley Lambert for this tip!):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@flood_widget</span><span class="o">.</span><span class="n">delta</span><span class="o">.</span><span class="n">changed</span><span class="o">.</span><span class="n">connect</span>  <span class="c1"># Connect a function to delta (spinbox widget)</span>
<span class="k">def</span> <span class="nf">update_level</span><span class="p">(</span><span class="n">delta</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">flood_widget</span><span class="o">.</span><span class="n">new_level</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">*</span> <span class="mi">85</span>  <span class="c1"># Update slider when spinbox changes</span>
</pre></div>
</div>
<p>You can look for further documentation and tutorials at <a class="reference external" href="https://napari.org/magicgui/usage/quickstart.html">magicgui quickstart</a> and <a class="reference external" href="https://napari.org/guides/stable/magicgui.html">magicgui in napari</a>.</p>
</section>
<section id="creating-a-gui-from-functiongui">
<h2>Creating a GUI from FunctionGui<a class="headerlink" href="#creating-a-gui-from-functiongui" title="Permalink to this heading">#</a></h2>
<p>The third approach is a more straightforward one. By using and modifying FunctionGui (the type that is returned by magicgui), we can have a more direct access to all options.</p>
<p>We keep the annotated version of our function, but instead of passing it to magicgui, we will define a new <code class="docutils literal notranslate"><span class="pre">FunctionGui</span></code> class, based on <a class="reference external" href="https://napari.org/guides/stable/magicgui.html#magicgui-widgets-functiongui">this example</a> and pass our flood function to <code class="docutils literal notranslate"><span class="pre">FunctionGui</span></code>. So, I will start with the code shown below:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">flood</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">ImageData</span><span class="p">,</span> <span class="n">delta</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_level</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelsData</span><span class="p">:</span> 
    <span class="n">new_level</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="mi">85</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">image</span> <span class="o">&lt;=</span> <span class="n">new_level</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">label_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span> <span class="c1"># label 13 is blue in napari</span>
    <span class="k">return</span><span class="p">(</span><span class="n">label_image</span><span class="p">)</span>
    
<span class="k">class</span> <span class="nc">MyGui</span><span class="p">(</span><span class="n">FunctionGui</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
          <span class="n">flood</span><span class="p">,</span>                <span class="c1"># Here is where we pass our custom annotated function to FunctionGui</span>
          <span class="n">call_button</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
          <span class="n">param_options</span><span class="o">=</span><span class="p">{}</span>
        <span class="p">)</span>
        <span class="c1"># do whatever other initialization you want here</span>
</pre></div>
</div>
<p>If we open napari, add our image and add MyGui to napari, we get the same result as shown <span class="xref myst">before</span> (full code at the end of this section).</p>
<p>Similarly, to match the widgets style we want (like in <span class="xref myst">previous results</span>), we can provide dictionaries to the <code class="docutils literal notranslate"><span class="pre">param_options</span></code>, like this:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyGui</span><span class="p">(</span><span class="n">FunctionGui</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
          <span class="n">flood</span><span class="p">,</span>                <span class="c1"># Here is where we pass our custom annotated function to FunctionGui</span>
          <span class="n">call_button</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
          <span class="n">param_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;delta&#39;</span><span class="p">:</span>
                             <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature Increase (Δ°C):&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
                        <span class="s1">&#39;new_level&#39;</span><span class="p">:</span>
                            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;Sea Level (dm):&#39;</span><span class="p">,</span> <span class="s1">&#39;widget_type&#39;</span><span class="p">:</span><span class="s1">&#39;Slider&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span> <span class="p">:</span> <span class="mi">255</span><span class="p">,</span> <span class="s1">&#39;step&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
        <span class="p">)</span>
        <span class="c1"># do whatever other initialization you want here</span>
</pre></div>
</div>
<p>We can modify the <code class="docutils literal notranslate"><span class="pre">__init()__</span></code> and the <code class="docutils literal notranslate"><span class="pre">__call()__</span></code> functions to gain access to other widgets and get/send other variables that are not images. For example, besides <code class="docutils literal notranslate"><span class="pre">label_image</span></code>, we can make our function return <code class="docutils literal notranslate"><span class="pre">new_level</span></code> again as an annotation and use its value to change the slider when the user hits the ‘Run’ button. Check the complete code and result below:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">napari</span>
<span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>
<span class="kn">from</span> <span class="nn">napari.types</span> <span class="kn">import</span> <span class="n">ImageData</span><span class="p">,</span> <span class="n">LabelsData</span><span class="p">,</span> <span class="n">LayerDataTuple</span>
<span class="kn">from</span> <span class="nn">magicgui.widgets</span> <span class="kn">import</span> <span class="n">FunctionGui</span>

<span class="k">def</span> <span class="nf">flood</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">ImageData</span><span class="p">,</span> <span class="n">delta</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_level</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LayerDataTuple</span><span class="p">:</span>
    <span class="n">new_level</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="mi">85</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">image</span> <span class="o">&lt;=</span> <span class="n">new_level</span>
    <span class="n">label_image</span> <span class="o">=</span> <span class="n">label_image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span> <span class="c1"># label 13 is blue in napari</span>
    <span class="k">return</span><span class="p">((</span><span class="n">label_image</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;flood result&#39;</span><span class="p">,</span><span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;new_level&#39;</span><span class="p">:</span><span class="n">new_level</span><span class="p">}}))</span>

<span class="k">class</span> <span class="nc">MyGui</span><span class="p">(</span><span class="n">FunctionGui</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
          <span class="n">flood</span><span class="p">,</span>
          <span class="n">call_button</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">auto_call</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
          <span class="n">param_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;delta&#39;</span><span class="p">:</span>
                             <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature Increase (Δ°C):&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
                        <span class="s1">&#39;new_level&#39;</span><span class="p">:</span>
                            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;Sea Level (dm):&#39;</span><span class="p">,</span> <span class="s1">&#39;widget_type&#39;</span><span class="p">:</span><span class="s1">&#39;Slider&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span> <span class="p">:</span> <span class="mi">255</span><span class="p">,</span> <span class="s1">&#39;enabled&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">}}</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">label_image</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">()</span>
        <span class="n">new_level</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">label_image</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;new_level&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_level</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">new_level</span>


<span class="n">napari_image</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;21_Map_of_Tabuaeran_Kiribati_blue.png&#39;</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">napari_image</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;napari_island&#39;</span><span class="p">)</span>

<span class="n">flood_widget</span> <span class="o">=</span> <span class="n">MyGui</span><span class="p">()</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">add_dock_widget</span><span class="p">(</span><span class="n">flood_widget</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="../../_images/napari_flood_tool5.png" /></p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>We have implemented our GUI in 3 different ways! Check which way is advantageous for you and play with it a little bit, because in the next part we will teach you how to turn it into a napari plugin and distribute it 🎉</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./marcelo_zoccoler/entry_user_interf3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../../johannes_mueller/entry_user_interf2/Readme.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Custom user interfaces for Python (Part 2)</p>
      </div>
    </a>
    <a class="right-next"
       href="../entry_user_interf4/Readme.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Custom user interfaces for Python (Part 4)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Custom user interfaces for Python (Part 3)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-advanced-guis-for-napari">Creating advanced GUIs for napari</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-and-running-napari">Installing and running napari</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calling-napari-from-a-script">Calling napari from a script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-your-fancy-gui-to-napari">Importing your fancy GUI to napari</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-callback-function">Creating a callback function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#automatically-creating-a-gui-from-a-function-with-magicgui">Automatically creating a GUI from a function with magicgui</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-gui-from-functiongui">Creating a GUI from FunctionGui</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Marcelo Zoccoler, Johannes Müller, Till Korten, Ryan Savill, Mara Lampert, Robert Haase, DFG Cluster of Excellence "Physics of Life", TU Dresden
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>